--------------------------------------- Const
    Î“ Í¾ Î£ Í¾ gc ; pc âŠ¢ $ k â‡ ` Bool of â„“

             Î£(n â„“Ì‚) â‰¡ just T
------------------------------------------------- Addr
    Î“ Í¾ Î£ Í¾ gc âŠ¢ addr n â„“Ì‚ â‡ Ref (T of â„“Ì‚) of â„“

         Î“ âˆ‹ x â¦‚ A
---------------------------------- Var
    Î“ Í¾ Î£ Í¾ gc âŠ¢ ` x â‡ A

           âˆ€ pc. A âˆ· Î“ Í¾ Î£ Í¾ g ; pc âŠ¢ N â‡ B
---------------------------------------------- Lambda
    Î“ Í¾ Î£ Í¾ gc âŠ¢ Æ› N â‡ âŸ¦ g âŸ§ A â†’ B of â„“

  Î“ Í¾ Î£ Í¾ pcâ€² ; pc âŠ¢ L â‡ âŸ¦ â„“á¶œ âŸ§ A â†’ B of â„“
  Î“ Í¾ Î£ Í¾ pcâ€² ; pc âŠ¢ M â‡ A
              pcâ€² â‹ â„“ â‰¼ â„“á¶œ
               C = stamp B â„“
--------------------------------------- App
  Î“ Í¾ Î£ Í¾ pcâ€² ; pc âŠ¢ app L M â„“á¶œ A B â„“ â‡ C

    Î“ Í¾ Î£ Í¾ gc ; pc âŠ¢ L â‡ âŸ¦ â‹† âŸ§ A â†’ B of g
    Î“ Í¾ Î£ Í¾ gc ; pc âŠ¢ M â‡ A
               C = stamp B g
--------------------------------------- App!
    Î“ Í¾ Î£ Í¾ gc ; pc âŠ¢ app! L M A B g â‡ C

    Î“ Í¾ Î£ Í¾ pcâ€² ; pc âŠ¢ L â‡ ` Bool of â„“
    âˆ€ pc. Î“ Í¾ Î£ Í¾ pcâ€² â‹ â„“ ; pc âŠ¢ M â‡ A
    âˆ€ pc. Î“ Í¾ Î£ Í¾ pcâ€² â‹ â„“ ; pc âŠ¢ N â‡ A
               B = stamp A â„“
---------------------------------------- If
    Î“ Í¾ Î£ Í¾ pcâ€² ; pc âŠ¢ if L A â„“ M N â‡ B

    Î“ Í¾ Î£ Í¾ gc ; pc âŠ¢ L â‡ ` Bool of g
    âˆ€ pc. Î“ Í¾ Î£ Í¾ â‹† ; pc âŠ¢ M â‡ A
    âˆ€ pc. Î“ Í¾ Î£ Í¾ â‹† ; pc âŠ¢ N â‡ A
               B = stamp A g
---------------------------------------- If!
    Î“ Í¾ Î£ Í¾ gc ; pc âŠ¢ if! L A g M N â‡ B

    Î“ Í¾ Î£ Í¾ gc ; pc âŠ¢ M â‡ A
    âˆ€ pc. A âˆ· Î“ Í¾ Î£ Í¾ gc ; pc âŠ¢ N â‡ B
--------------------------------------- Let
    Î“ Í¾ Î£ Í¾ gc ; pc âŠ¢ `let M A N â‡ B

    Î“ Í¾ Î£ Í¾ pcâ€² ; pc âŠ¢ M â‡ T of l â„“
               pcâ€² â‰¼ â„“
      A = Ref (T of l â„“) of low
-------------------------------------- RefStatic
    Î“ Í¾ Î£ Í¾ pcâ€² ; pc âŠ¢ refâŸ¦ â„“ âŸ§ T M â‡ A

    Î“ Í¾ Î£ Í¾ â‹† ; pc âŠ¢ M â‡ T of l â„“
      A = Ref (T of l â„“) of low
-------------------------------------- Ref?
    Î“ Í¾ Î£ Í¾ â‹† ; pc âŠ¢ ref?âŸ¦ â„“ âŸ§ T M p â‡ A

    Î“ Í¾ Î£ Í¾ gc Í¾ pc âŠ¢ M â‡ T of l â„“
               pc â‰¼ â„“
      A = Ref (T of l â„“) of l low
---------------------------------------------------------- Refâœ“
    Î“ Í¾ Î£ Í¾ gc Í¾ pc âŠ¢ refâœ“âŸ¦ â„“ âŸ§ T M â‡ A

* Alternative rules for reference creation:

    Î“ Í¾ Î£ Í¾ pcâ€² ; pc âŠ¢ M â‡ T of l â„“
               pcâ€² â‰¼ â„“
      A = Ref (T of l â„“) of low
-------------------------------------- RefStatic
    Î“ Í¾ Î£ Í¾ pcâ€² ; pc âŠ¢ refâŸ¦ â„“ âŸ§ T M â‡ A

    Î“ Í¾ Î£ Í¾ â‹† ; pc âŠ¢ M â‡ T of l â„“
      A = Ref (T of l â„“) of low
-------------------------------------- Ref?
    Î“ Í¾ Î£ Í¾ â‹† ; pc âŠ¢ ref?âŸ¦ â„“ âŸ§ T M p â‡ A



   Î“ Í¾ Î£ Í¾ gc Í¾ pc âŠ¢ M â‡ Ref A of g
             B = stamp A g
--------------------------------------------- Deref
   Î“ Í¾ Î£ Í¾ gc Í¾ pc âŠ¢ ! M A g â‡ B


   Î“ Í¾ Î£ Í¾ l pcâ€² Í¾ pc âŠ¢ L â‡ Ref (T of l â„“Ì‚) of l â„“
   Î“ Í¾ Î£ Í¾ l pcâ€² Í¾ pc âŠ¢ M â‡ T of l â„“Ì‚
            pcâ€² â‹ â„“ â‰¼ â„“Ì‚
             A = Unit
--------------------------------------------- AssignStatic
   Î“ Í¾ Î£ Í¾ l pcâ€² Í¾ pc âŠ¢ assign L M T â„“Ì‚ â„“ â‡ A

   Î“ Í¾ Î£ Í¾ gc Í¾ pc âŠ¢ L â‡ Ref (T of â‹†) of â‹†
   âˆ€ pc. Î“ Í¾ Î£ Í¾ gc Í¾ pc âŠ¢ M â‡ T of â‹†
             A = Unit
---------------------------------------------------- Assign?
   Î“ Í¾ Î£ Í¾ gc Í¾ pc âŠ¢ assign? L M T p â‡ A

   Î“ Í¾ Î£ Í¾ gc Í¾ pc âŠ¢ L â‡ Ref (T of l â„“Ì‚) of l â„“
   Î“ Í¾ Î£ Í¾ gc Í¾ pc âŠ¢ M â‡ T of l â„“Ì‚
           pc â‹ â„“ â‰¼ â„“Ì‚
             A = Unit
--------------------------------------------- Assignâœ“
   Î“ Í¾ Î£ Í¾ gc Í¾ pc âŠ¢ assignâœ“ L M T â„“Ì‚ â„“ â‡ A


* Alternative rules for assignment:

   Î“ Í¾ Î£ Í¾ l pcâ€² Í¾ pc âŠ¢ L â‡ Ref (T of l â„“Ì‚) of l â„“
   Î“ Í¾ Î£ Í¾ l pcâ€² Í¾ pc âŠ¢ M â‡ T of l â„“Ì‚
            pcâ€² â‹ â„“ â‰¼ â„“Ì‚
             A = Unit
--------------------------------------------- AssignStatic
   Î“ Í¾ Î£ Í¾ l pcâ€² Í¾ pc âŠ¢ assign L M T â„“Ì‚ â„“ â‡ A

   Î“ Í¾ Î£ Í¾ gc Í¾ pc âŠ¢ L â‡ Ref (T of â‹†) of g
   Î“ Í¾ Î£ Í¾ gc Í¾ pc âŠ¢ M â‡ T of â‹†
             A = Unit
---------------------------------------------------- Assign?
   Î“ Í¾ Î£ Í¾ gc Í¾ pc âŠ¢ assign? L M T p â‡ A

   Î“ ; Î£ ; â„“ ; â„“ âŠ¢ M â‡ A
----------------------------------- ProtPC
   Î“ ; Î£ ; gc ; pc âŠ¢ â¦ƒ â„“ â¦„ M â‡ A

   Î“ ; Î£ ; â‹† ; â„“ âŠ¢ M â‡ A
----------------------------------- ProtPC!
   Î“ ; Î£ ; gc ; pc âŠ¢ â¦ƒ â„“ âŸ¨ â„“ ! âŸ© â¦„ M â‡ A

   Î“ ; Î£ ; gc ; pc âŠ¢ M â‡ A
        B = stamp A â„“
----------------------------------------- ProtVal
   Î“ ; Î£ ; gc ; pc âŠ¢ M âŸª â„“ âŸ« â‡ B

Note: in the proof version we may instead have a term `prot ğ“‹ â„“ M`
whose typing includes a constraint `â„“ â‰¼ â„“â€²` where â„“â€² is the security
level of ğ“‹.

   Î“ Í¾ Î£ Í¾ gc âŠ¢ M â‡ A   c : A â‡’ B
-------------------------------------------- Cast
   Î“ Í¾ Î£ Í¾ gc âŠ¢ M âŸ¨ c âŸ© â‡ B

------------------------------------ Blame
   Î“ Í¾ Î£ Í¾ gc âŠ¢ blame p â‡ A
